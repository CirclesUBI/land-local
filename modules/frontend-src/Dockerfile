FROM node:lts

ARG API_ENDPOINT
ENV API_ENDPOINT=$API_ENDPOINT

ARG DEFAULT_APP_LANGUAGE
ENV DEFAULT_APP_LANGUAGE=$DEFAULT_APP_LANGUAGE

ARG CIRCLES_SUBGRAPH_ENDPOINT
ENV CIRCLES_SUBGRAPH_ENDPOINT=$CIRCLES_SUBGRAPH_ENDPOINT

ARG PATHFINDER_ENDPOINT
ENV PATHFINDER_ENDPOINT=$PATHFINDER_ENDPOINT

ARG CIRCLES_HUB_ADDRESS
ENV CIRCLES_HUB_ADDRESS=$CIRCLES_HUB_ADDRESS

ARG SAFE_PROXY_FACTORY_ADDRESS
ENV SAFE_PROXY_FACTORY_ADDRESS=$SAFE_PROXY_FACTORY_ADDRESS

ARG SAFE_ADDRESS
ENV SAFE_ADDRESS=$SAFE_ADDRESS

ARG RPC_ENDPOINT
ENV RPC_ENDPOINT=$RPC_ENDPOINT

ARG OPENLOGIN_CLIENT_ID
ENV OPENLOGIN_CLIENT_ID=$OPENLOGIN_CLIENT_ID

ARG HERE_API_KEY
ENV HERE_API_KEY=$HERE_API_KEY

ARG PLACES_API_KEY
ENV PLACES_API_KEY=$PLACES_API_KEY

ARG IS_PRODUCTION
ENV IS_PRODUCTION=$IS_PRODUCTION

ARG USE_MOCKS
ENV USE_MOCKS=$USE_MOCKS

ARG SHOW_LANGUAGE_SWITCHER
ENV SHOW_LANGUAGE_SWITCHER=$SHOW_LANGUAGE_SWITCHER

ARG I18N_FILE_URL_TEMPLATE
ENV I18N_FILE_URL_TEMPLATE=$I18N_FILE_URL_TEMPLATE

RUN apt update
RUN apt install -y inotify-tools

WORKDIR /o-platform
RUN rm -f shell/public/bundle.js
CMD ./build_libs.sh && cd shell && npm run docker
